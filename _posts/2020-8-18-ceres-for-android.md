---
layout: post
title:  Build full feature Ceres Solver for Android
categories: [SLAM,Android]
---

If you ever tried to implement google Ceres solver on Android, you would know that ceres' official doc doesn't provide enough detail for the task. Although it won't take long before you can compile an "Eigen only" version following ceres' installation guide, you still wonder, if adding the suitesparse support can make a faster version. In this post I will record the process of building a SuiteSparse-enabled version of ceres for Android, and conduct a comparison of the "Eigen only" version and the SuiteSparse-enabled version in terms of solver efficiency. The post will be organized as follows:

- Cmake tips
- Strip down Ceres Solver
- Solving dependecies
- Generating test executables for Android
- Performance comparison

## Cmake tips

I benefit from this [post](https://pabloariasal.github.io/2018/02/19/its-time-to-do-cmake-right/) when I tried to pick up some knowledge about Cmake. The author also pointed me to find an awesome [video](https://www.youtube.com/watch?v=bsXLMQ6WgIk) introducing the general principles about Cmake. My take-away is that, no matter how complicated a cmake project seems, it's just a combination of **targets**, each having their own **properties** and dependency targets. The general principle will be for each cmake project, we only need to construct its bone structure as
```shell
cmake_minimum_required()
project()
add_executable()/add_library()
target_link_libraries()
target_include_directories()
```
And if the project depends on external projects, all we need is to find a way to import the **libs** and **includes** generated by those dependency projects such as **find_package()**, other optional flags like xxxPackage_Found and xxxPackage_VERSION etc. are just for conditional variations of the build process.

## Strip down Ceres Solver

Download [Ceres Solver](http://ceres-solver.org/installation.html) and take a look at the root CMakeLists.txt. You might be intimidated by its size and all kinds of branches. Here we simplify it to only consider Android platform.